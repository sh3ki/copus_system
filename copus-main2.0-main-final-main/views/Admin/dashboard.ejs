<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        :root {
            --primary-color-start: #0f2027; /* Dark blue */
            --primary-color-end: #203a43; /* Darker blue */
            --secondary-color-start: #2c5364; /* Blue-green */
            --secondary-color-end: #203a43; /* Darker blue */
            --text-light: #e0e0e0;
            --text-dark: #333;
            --sidebar-width: 280px;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, var(--primary-color-start), var(--primary-color-end));
            color: var(--text-light);
            min-height: 100vh;
        }

        /* Header styles */
        header {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: fixed;
            top: 0;
            left: var(--sidebar-width);
            right: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            transition: left 0.3s ease-in-out;
        }

        .logo {
            display: flex;
            align-items: center;
            font-weight: 600;
            font-size: 1.5rem;
            color: #fff;
        }
        .logo i {
            font-size: 1.5rem;
            margin-right: 15px;
        }

        .header-title {
            font-size: 1.25rem;
            color: var(--text-light);
            margin-left: -150px;
        }

        .header-icons {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        .header-icons i {
            font-size: 1.5rem;
            color: var(--text-light);
            cursor: pointer;
            transition: color 0.3s;
        }
        .header-icons i:hover {
            color: #17e891;
        }
        .user-icon-circle {
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.25rem;
        }

       /* --- Sidebar --- */
.custom-sidebar {
  width: var(--sidebar-width);
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
   background: linear-gradient(to bottom, #11405b, #0f2027);
  color: var(--text-light);
  padding: 2rem 1.5rem;
  display: flex;
  flex-direction: column;
  box-shadow: 2px 0 15px rgba(0, 0, 0, 0.3);
  z-index: 1001;
}

.custom-sidebar h6 {
  font-size: 1.2rem;
  font-weight: 600;
  color: #fff;
  margin-bottom: 0.25rem;
}

.custom-sidebar small {
  color: rgba(255, 255, 255, 0.6);
}

.custom-sidebar hr {
  border-color: rgba(255, 255, 255, 0.1);
  margin: 1.5rem 0;
}

.custom-sidebar a {
    color: var(--text-light);
    text-decoration: none;
    padding: 0.75rem 1rem;
    margin-bottom: 0.5rem;
    border-radius: 8px;
    transition: background 0.3s, color 0.3s;
    display: flex;
    align-items: center;
    gap: 1rem;
    font-weight: bold;
}.custom-sidebar a i {
  font-size: 1.25rem;
}

.custom-sidebar a:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--accent-color);
}

.custom-sidebar a.active {
  background: linear-gradient(to right, #2c5364, #203a43);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  color: #fff;
}

.logout-btn {
  background: linear-gradient(to right, #e74c3c, #c0392b);
  border: none;
  color: #fff;
  padding: 0.75rem 1rem;
  border-radius: 8px;
  text-align: left;
  width: 100%;
  font-weight: 600;
  transition: transform 0.2s;
}

.logout-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}
/* --- Main Content --- */
.main-content {
    margin-left: var(--sidebar-width);
    padding: 10rem 4rem 4rem;
    transition: margin-left 0.3s ease-in-out;
    padding-top: 20px;
    padding-left: 20px;
}

.metric-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.metric-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    padding: 2rem;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease-in-out;
}

.metric-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.1);
}

.metric-icon {
    font-size: 3rem;
    color: #17e891;
    margin-bottom: 0.5rem;
}

.metric-value {
    font-size: 2.5rem;
    font-weight: 700;
    color: #fff;
}

.metric-label {
    font-size: 0.9rem;
    text-transform: uppercase;
    color: rgba(255, 255, 255, 0.7);
    letter-spacing: 1px;
}

.section-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #fff;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid rgba(255, 255, 255, 0.1);
}

#facultyChart {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 2rem;
    /* New styles for responsive sizing */
    max-width: 800px;
    height: 400px; /* Added height for visibility */
    margin: 0 auto 2rem;
}

/* --- Charts Section Styling --- */
.charts-section {
    margin-bottom: 2rem;
}

.chart-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    height: 400px;
    margin-bottom: 2rem;
}

.chart-card h5 {
    color: var(--text-light);
    margin-bottom: 1rem;
    font-weight: 600;
    text-align: center;
    font-size: 1.2rem;
}

.chart-card canvas {
    max-width: 100%;
    max-height: 300px;
}

.data-table {
    background-color: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.data-table thead tr {
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
}

.data-table th, .data-table td {
    border-color: rgba(255, 255, 255, 0.2);
    color: var(--text-light);
    white-space: nowrap;
}

#calendar {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
}

.fc-daygrid-day-number, .fc-col-header-cell-cushion {
    color: var(--text-light);
}

.fc-button-primary {
    background-color: #2c5364;
    border-color: #2c5364;
}

.fc-button-primary:hover {
    background-color: #203a43;
    border-color: #203a43;
}

@media (max-width: 992px) {
    :root {
        --sidebar-width: 0px;
    }

    .custom-sidebar {
        left: -280px;
    }

    .main-content, header {
        margin-left: 0;
    }
}
    </style>
</head>
<body>
    <div class="page-container">
        <div class="custom-sidebar">
            <h6>Welcome, <%= firstName %> <%= lastName %></h6>
            <small><%= employeeId %></small>
            <hr>
           <a href="/admin_copus_result"><i class="bi bi-clipboard-data"></i> Dashboard</a>
            <a href="/admin_user_management"><i class="bi bi-people-fill"></i> User Management</a>
            <a href="/admin_schedule"><i class="bi bi-calendar-event-fill"></i> Schedule</a>
           
            <a href="/admin_copus_history"><i class="bi bi-clock-history"></i> Copus History</a>
            <a href="/admin_copus_appointments"><i class="bi bi-calendar-check"></i> COPUS Appointments</a>
            <a href="/admin_setting"><i class="bi bi-gear-fill"></i> Settings</a>
            <hr>
            <form action="/logout" method="POST">
                <button type="submit" class="logout-btn">Logout</button>
            </form>
        </div>
        <main class="main-content">
          
<div class="he section-title">
¬† ¬† <div class="title-with-icon">
¬† ¬† ¬† 
¬† ¬† ¬† 
¬† ¬† </div>
    <canvas id="facultyChart" style="height: 400px; width: 100%;"></canvas>
</div>

          

            <!-- Charts Section -->
            <div class="charts-section">
                <div class="section-title">üìä COPUS ANALYTICS DASHBOARD</div>
                
                <!-- Top Overall Score Chart -->
                <div class="chart-card">
                    <h5>üèÜ Top Overall Score</h5>
                    <canvas id="topOverallChart" width="100%" height="300"></canvas>
                </div>
                
                <!-- Top 10 Highest Scores Chart -->
                <div class="chart-card">
                    <h5>üìà Top 10 Highest Scores</h5>
                    <canvas id="topHighestChart" width="100%" height="300"></canvas>
                </div>
                
                <!-- Top 10 Lowest Scores Chart -->
                <div class="chart-card">
                    <h5>üìâ Top 10 Lowest Scores</h5>
                    <canvas id="topLowestChart" width="100%" height="300"></canvas>
                </div>
            </div>
        </main>
    </div>

    <div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="notificationModalLabel">Notifications</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>You have no new notifications.</p>
                    <p>Example: New Copus Result for [Faculty Name] is available.</p>
                    <p>Example: Appointment scheduled with [Faculty Name] on [Date] at [Time].</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">View All</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Chart.js
        const ctx = document.getElementById('facultyChart').getContext('2d');
        const facultyChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Student Listening to Class', 'Student Taking Notes', 'Student Taking Photos', 'Student asking questions', 'Student Answering questions', 'Student presenting', 'Students performing activities', 'Student discussing', 'Student with no visible action'],
                datasets: [{
                    label: 'Average Student Actions',
                    data: [20, 10, 5, 15, 25, 5, 10, 5, 5],
                    backgroundColor: [
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)',
                        'rgba(23, 232, 145, 0.5)'
                    ],
                    borderColor: [
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)',
                        'rgba(23, 232, 145, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true, // Change this to true
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)',
                        },
                        ticks: {
                            color: 'var(--text-light)',
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)',
                        },
                        ticks: {
                            color: 'var(--text-light)',
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false,
                    }
                }
            }
        });

        // Initialize Chart Data (placeholder - should come from server)
        const chartData = {
            topOverall: {
                faculty_name: 'Top Faculty',
                overall_percentage: 95,
                final_rating: 'Excellent'
            },
            topHighest: [
                { faculty_name: 'Faculty A', overall_percentage: 95 },
                { faculty_name: 'Faculty B', overall_percentage: 92 },
                { faculty_name: 'Faculty C', overall_percentage: 89 },
                { faculty_name: 'Faculty D', overall_percentage: 87 },
                { faculty_name: 'Faculty E', overall_percentage: 85 }
            ],
            topLowest: [
                { faculty_name: 'Faculty F', overall_percentage: 65 },
                { faculty_name: 'Faculty G', overall_percentage: 68 },
                { faculty_name: 'Faculty H', overall_percentage: 70 },
                { faculty_name: 'Faculty I', overall_percentage: 72 },
                { faculty_name: 'Faculty J', overall_percentage: 75 }
            ]
        };
        
        // Create Top Overall Score Chart
        if (chartData.topOverall) {
            const topOverallCtx = document.getElementById('topOverallChart').getContext('2d');
            new Chart(topOverallCtx, {
                type: 'bar',
                data: {
                    labels: [chartData.topOverall.faculty_name || 'N/A'],
                    datasets: [{
                        label: 'Score (%)',
                        data: [chartData.topOverall.overall_percentage || 0],
                        backgroundColor: '#17e891',
                        borderColor: '#15d084',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: `${chartData.topOverall.overall_percentage || 0}% - ${chartData.topOverall.final_rating || 'N/A'}`,
                            color: '#e0e0e0'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#e0e0e0' },
                            grid: { color: 'rgba(224, 224, 224, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#e0e0e0' },
                            grid: { color: 'rgba(224, 224, 224, 0.1)' }
                        }
                    }
                }
            });
        }
        
        // Create Top 10 Highest Scores Chart
        if (chartData.topHighest && chartData.topHighest.length > 0) {
            const topHighestCtx = document.getElementById('topHighestChart').getContext('2d');
            new Chart(topHighestCtx, {
                type: 'bar',
                data: {
                    labels: chartData.topHighest.map(item => item.faculty_name || 'N/A'),
                    datasets: [{
                        label: 'Score (%)',
                        data: chartData.topHighest.map(item => item.overall_percentage || 0),
                        backgroundColor: '#28a745',
                        borderColor: '#20c997',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#e0e0e0', font: { size: 10 } },
                            grid: { color: 'rgba(224, 224, 224, 0.1)' }
                        },
                        x: {
                            ticks: { 
                                color: '#e0e0e0', 
                                font: { size: 10 },
                                maxRotation: 45
                            },
                            grid: { color: 'rgba(224, 224, 224, 0.1)' }
                        }
                    }
                }
            });
        }
        
        // Create Top 10 Lowest Scores Chart
        if (chartData.topLowest && chartData.topLowest.length > 0) {
            const topLowestCtx = document.getElementById('topLowestChart').getContext('2d');
            new Chart(topLowestCtx, {
                type: 'bar',
                data: {
                    labels: chartData.topLowest.map(item => item.faculty_name || 'N/A'),
                    datasets: [{
                        label: 'Score (%)',
                        data: chartData.topLowest.map(item => item.overall_percentage || 0),
                        backgroundColor: '#dc3545',
                        borderColor: '#e74c3c',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: '#e0e0e0', font: { size: 10 } },
                            grid: { color: 'rgba(224, 224, 224, 0.1)' }
                        },
                        x: {
                            ticks: { 
                                color: '#e0e0e0', 
                                font: { size: 10 },
                                maxRotation: 45
                            },
                            grid: { color: 'rgba(224, 224, 224, 0.1)' }
                        }
                    }
                }
            });
        }
    });
</script>

<!-- Bootstrap JS (required for modal functionality) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Include Account Activation Modal (shows first) -->
<%- include('../partials/account-activation-modal') %>

<!-- Include First-Login Modal (shows after activation) -->
<%- include('../partials/first-login-modal') %>

</body>
</html>